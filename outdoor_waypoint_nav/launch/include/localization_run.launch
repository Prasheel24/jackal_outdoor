<?xml version="1.0"?>
<launch>
  <param name="use_sim_time" type="bool" value="True"/>
   <arg name="ekf" default="true" />

    <node if="$(arg ekf)" pkg="tf" type="static_transform_publisher" name="base_link_to_chassis_link" args="0 0 0 0 0 0 1 /base_link /chassis_link 30" /> 
     <node if="$(arg ekf)" pkg="tf" type="static_transform_publisher" name="chassis_link_to_nav_link" args="0 0 0 0 0 0 1 /chassis_link /navsat_link 30" /> 
    <!-- <node if="$(arg ekf)" pkg="tf" type="static_transform_publisher" name="chassis_link_to_imu" args="0 0 0 0 0 0 1 /chassis_link /imu_link 30" />  -->

  <group ns="/outdoor_waypoint_nav"> 
  <rosparam command="load" file="$(find outdoor_waypoint_nav)/params/ekf_params.yaml" />
  <rosparam command="load" file="$(find outdoor_waypoint_nav)/params/navsat_params.yaml" />
  
  <node pkg="robot_localization" type="ekf_localization_node" name="ekf_se_odom" clear_params="true"/>
<!-- 
  <node pkg="robot_localization" type="ekf_localization_node" name="ekf_se_map" clear_params="true">
    <remap from="odometry/filtered" to="odometry/filtered_map"/>
  </node>
 -->
  <node pkg="robot_localization" type="navsat_transform_node" name="navsat_transform" clear_params="true" output="screen">
      <!-- <remap from="odometry/filtered" to="/outdoor_waypoint_nav/odometry/filtered"/> -->
      <remap from="gps/fix" to="/ublox/fix"/>
      <remap from="imu/data" to="/new_imu"/>
  </node>
  </group>
<node pkg="rviz" type="rviz" name="rviz" args="-d $(find outdoor_waypoint_nav)/rviz_config/outdoor_waypoint_nav_continuous_rviz.rviz" output="screen"/>
</launch>
